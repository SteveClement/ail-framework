version: '3'
networks:
    networks: [ail-network]
  ail-network:
    driver: bridge

    ports: ["7000:7000"]

  redis-log:
    networks: [ail-network]
    # No external ports needed
services:
  ardb:
    entrypoint:
      - ardb-server
      - /opt/AIL/configs/6382.conf
    healthcheck:
      test: ["CMD", "redis-cli", "-p", "6382", "ping"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./configs:/opt/AIL/configs:ro
  crawler:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Crawler.py
      - onion
      - "8050"
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./CRAWLED_SCREENSHOT/:/opt/AIL/CRAWLED_SCREENSHOT
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  flask:
    build: .
    entrypoint:
      - /opt/AIL/var/www/Flask_server.py
    ports:
      - "7000:7000"
    image: ail-framework
    volumes:
      - ./CRAWLED_SCREENSHOT/:/opt/AIL/CRAWLED_SCREENSHOT
      - ./PASTES/:/opt/AIL/PASTES
      - ./indexdir:/opt/AIL/indexdir
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/var/www
  log-queue:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/AILENV/bin/log_subscriber
      - -p
      - "6380"
      - -c
      - Queing
      - -l
      - /opt/AIL/logs/
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./configs:/opt/AIL/configs:ro
  log-script:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/AILENV/bin/log_subscriber
      - -p
      - "6380"
      - -c
      - Script
      - -l
      - /opt/AIL/logs/
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./configs:/opt/AIL/configs:ro
  pystemon:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/pystemon/pystemon.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./pystemon/archives:/opt/pystemon/archive
      - ./pystemon/proxies.txt:/opt/pystemon/proxies.txt:ro
      - ./pystemon/pystemon.yaml:/opt/pystemon/pystemon.yaml:ro
    working_dir: /opt/pystemon
  pystemon-feeder:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/feeder/pystemon-feeder.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./pystemon/archives:/opt/pystemon/archive
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  queues:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/launch_queues.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  redis-cache:
    entrypoint:
      - redis-server
      - /opt/AIL/configs/6379.conf
    healthcheck:
      test: ["CMD", "redis-cli", "-p", "6379", "ping"]
      interval: 30s
      timeout: 10s
      retries: 5
    image: ail-framework
    networks: [ail-network]
    volumes:
      - ./configs:/opt/AIL/configs:ro
  redis-log:
    entrypoint:
      - redis-server
      - /opt/AIL/configs/6380.conf
    healthcheck:
      test: ["CMD", "redis-cli", "-p", "6380", "ping"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./configs:/opt/AIL/configs:ro
  redis-mixer-cache:
    entrypoint:
      - redis-server
      - /opt/AIL/configs/6381.conf
    healthcheck:
      test: ["CMD", "redis-cli", "-p", "6381", "ping"]
      interval: 30s
      timeout: 10s
      retries: 5
    image: ail-framework
    networks: [ail-network]
    volumes:
      - ./configs:/opt/AIL/configs:ro
  script-alerthandler:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/alertHandler.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-apikey:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/ApiKey.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-bankaccount:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/BankAccount.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-bitcoin:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Bitcoin.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-categ:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Categ.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-credential:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Credential.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-creditcards:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/CreditCards.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-curve:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Curve.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-curvemanagetopsets:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/CurveManageTopSets.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-cve:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/CveModule.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-decoder:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Decoder.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./HASHS:/opt/AIL/HASHS
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-domclassifier:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/DomClassifier.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-duplicates:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Duplicates.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-global:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Global.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-indexer:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Indexer.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./indexdir:/opt/AIL/indexdir
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-keys:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Keys.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-libinjection:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/LibInjection.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-lines:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Lines.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-mail:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Mail.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-mispthehivefeeder:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/MISP_The_Hive_feeder.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-mixer:
    depends_on:
      - redis-mixer-cache
    entrypoint:
      - /opt/AIL/bin/Mixer.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-modulestats:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/ModuleStats.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-onion:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Onion.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-phone:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Phone.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-regexfortermsfrequency:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/RegexForTermsFrequency.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-release:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Release.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-sentimentanalysis:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/SentimentAnalysis.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-setfortermsfrequency:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/SetForTermsFrequency.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-sqlinjectiondetection:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/SQLInjectionDetection.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-submitpaste:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/submit_paste.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-tags:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Tags.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-tokenize:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Tokenize.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-web:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/Web.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
  script-webstats:
    depends_on:
      - redis-log
    entrypoint:
      - /opt/AIL/bin/WebStats.py
    networks: [ail-network]
    image: ail-framework
    volumes:
      - ./PASTES/:/opt/AIL/PASTES
      - ./bin/packages/config.cfg:/opt/AIL/bin/packages/config.cfg:ro
    working_dir: /opt/AIL/bin
